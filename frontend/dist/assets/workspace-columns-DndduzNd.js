import{j as e,c as l,t as d}from"./index-BIpb7VEJ.js";import{M as _}from"./Modal-CMAZ7A_o.js";import{D as o}from"./workspace-table-YnT_YtZx.js";import{c as w}from"./createLucideIcon-BFWoEbaP.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]],N=w("clipboard-copy",k),E=({fieldAssistants:p,handleGenerateKey:h,fieldAssistantId:m,setFieldAssistantId:u,loading:g,setWorkspaceData:x,workspaceData:y,isModalOpen:b,setModalOpen:s,selectedWorkspaceId:r,setSelectedWorkspaceId:v})=>[{accessorKey:"status",header:({column:t})=>e.jsx(o,{column:t,title:""}),cell:({row:t})=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("span",{className:`ml-2 rounded-full p-1 text-xs ${t.original?.is_activated?"bg-[#20B974]":"bg-[#EA4E4E]"}`})}),meta:{className:"w-12"},filterFn:(t,a,n)=>n.includes(t.getValue(a)),enableHiding:!1,enableSorting:!1},{accessorKey:"name",header:({column:t})=>e.jsx(o,{column:t,title:"Workspaces"}),cell:({row:t})=>e.jsx("div",{className:"text-foreground",children:t.getValue("name")})},{accessorKey:"created_at",header:({column:t})=>e.jsx(o,{column:t,title:"Onboarding Date & Time"}),cell:({row:t})=>{const a=new Date(t.getValue("created_at")),n=a.toLocaleDateString(),i=a.toLocaleTimeString();return e.jsx("div",{className:"text-foreground",children:`${n} ( ${i} )`})}},{id:"activation_key",header:"Activation Key",cell:({row:t})=>{const a=t.original;if(!a.activation_key)return e.jsx("span",{className:"text-gray-400 italic"});const n=!a.is_activated&&a.failed_activation_attempts>2;return e.jsxs("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(a.activation_key||""),d.success("Copied activation key to clipboard!",{position:"top-center"})},className:l("flex w-60 items-center justify-center gap-2 rounded-full p-2 text-white",a.is_activated===!1?"bg-red-500":a.is_activated===null?"cursor-not-allowed bg-orange-500":"bg-green-500",n?"border-2 border-red-700":""),children:[a.activation_key,e.jsx(N,{className:"h-4 w-4"})]})}},{accessorKey:"field_assistant_name",header:({column:t})=>e.jsx(o,{column:t,title:"Assistant Field Engineer"}),cell:({row:t})=>e.jsx("div",{className:"text-foreground",children:t.getValue("field_assistant_name")||"N/A"})},{id:"generate_key",header:"Generate Key",cell:({row:t})=>{const a=t.original,n=async()=>{if(r){await h(r);try{const i=await fetch(`https://nexify.indusvision.ai/api/workspace/${r}/`);if(!i.ok)throw new Error("Failed to fetch updated workspace");const f=await i.json(),j=y.map(c=>c.id===r?{...c,...f}:c);x(j),setTimeout(()=>{window.location.reload()},[2e3])}catch{d.error("Failed to update workspace data",{position:"top-center"})}s(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:l("w-60 rounded px-2 py-1 text-white",a.activation_key?"bg-blue-500 hover:bg-blue-600":"bg-green-500 hover:bg-green-600"),onClick:()=>{v(a.id),s(!0)},children:a.activation_key?"Re-generate Key":"Generate Key"}),e.jsxs(_,{isOpen:b&&r===a.id,onClose:()=>s(!1),title:a.activation_key?"Re-generate Activation Key":"Generate Activation Key",isLoading:g,children:[e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2",children:["Enter the Field Assistant ID to"," ",a.activation_key?"re-generate":"generate"," a key."]}),e.jsxs("select",{className:"w-full rounded border px-2 py-1",value:m,onChange:i=>u(i.target.value),children:[e.jsx("option",{value:"",children:"Select Field Assistant"}),p.map(i=>e.jsxs("option",{value:i.id,children:[i.first_name," ",i.last_name," (",i.email||i.phone_number,")"]},i.id))]})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"rounded-full bg-[#B92424] px-5 py-1 text-white hover:bg-red-500",children:"Cancel"}),e.jsx("button",{type:"button",onClick:async()=>{await n(),s(!1)},className:"rounded-full bg-[#43996A] px-5 py-1 text-white hover:bg-green-600",children:"Confirm"})]})]})]})}}];export{E as c};
